name: Java Gradle Build

on:

  push:

    branches:

      - main  # Запуск workfow при пуше в ветку main

  pull_request:

    branches:

      - main  # Запуск workflow для pull request'ов в ветку main
permissions: 
   contents: write
jobs:

  build:

    name: Build with Gradle

    runs-on: ubuntu-latest  # Виртуальная машина с Ubuntu

    steps:

    - name: Checkout repository

      uses: actions/checkout@v2  # Клонируем репозиторий

    - name: Set up JDK

      uses: actions/setup-java@v1

      with:

        java-version: '8'  # Установка JDK 11
    - name: Make gradlew executable
      run: chmod +x ./gradlew
    - name: Cache Gradle packages 
      uses: actions/cache@v3 
      with: 
        path: cache-folder
        key: ${{ runner.os }}-cache-key
    - name: Use or generate the cache 
      if: steps.cache-action.outputs.cache-hit != 'true' 
      run: mkdir cache-folder
    - name: Build with Gradle

      run: ./gradlew build  # Запускаем сборку проекта
    - uses: actions/upload-artifact@v3

      with:
        name: libs

        path: build/libs # or path/to/artifact
    - name: Upload distributions Directory 
      uses: actions/upload-artifact@v2 
      with: 
        name: distributions-artifact 
        path: build/distributions
